<html>   
<head>
<title>VPN在线账号</title>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK rel=stylesheet type=text/css href="/msas/publiccss/pubcss.css">
<LINK rel=stylesheet type=text/css href="/msas/extjs/resources/css/ext-all.css">
<link rel="stylesheet" type="text/css" href="/msas/extjs/resources/css/feed-viewer.css" />
<LINK rel=stylesheet type=text/css href="/msas/extjs/resources/css/xtheme-default.css" id="xthemecss" >
<script type="text/javascript" src="/msas/extjs/adapter/ext/ext-base.js"></script>
<SCRIPT type=text/javascript  src="/msas/extjs/ext-all.js"></SCRIPT>

<script>
function sub(var1,var2){//alert(var1+" "+var2);
	var r=confirm("确定删除此项吗？");
	if(r==true){
         location.href="/main/main.xp?Fun=inreportdels+typ=3+file="+var1+"+reportdir="+var2;
    }else{
    	 return ;
    }
}
</script> 
<SCRIPT type=text/javascript>
    var reportstore;
	var mypagenum;
    var ll=1
    mypagenum=1; 
	 
	var srv,user,sip,allcount,pagenums;
	 
	var yy=(mypagenum-1)/pagenums +1 ;

    Ext.BLANK_IMAGE_URL = '/extjs/resources/images/default/s.gif';

	function gotoPage(pagenum)  
  {  
      
	 allcount=form1.allcount.value;
	 pagenums=form1.pagenum.value;  //每页显示条数

    if(pagenum<1){
      pagenum=1;   //第几页
    }  
    if(pagenum>yy){
      pagenum=yy;
    }
    form1.curpage.value = pagenum;
    form1.browsdopage.value= pagenum;
    mypagenum=pagenum;
    
    reportstore.load({params:{CurPg:mypagenum,Fun:'vpnonlineuser',allcount:allcount,pagenum:pagenums}});
  }

function checkme(p)
{
	var tt=p.value
	if (tt>yy)
	{
		MM_changeProp('browsdopage','','value',yy,'INPUT/TEXT')
	}
	if (tt==0)
	{
		MM_changeProp('browsdopage','','value','1','INPUT/TEXT')
	}
}

     
       Ext.onReady(function(){
	
	  		Ext.QuickTips.init();

				var detailEl;
				
				var myMask = new Ext.LoadMask(Ext.getBody(), 
				    {
				        	msg:"Please wait..."
				    });
				myMask.show();
				 
		
		 	
			var cm=new Ext.grid.ColumnModel([
				{header:'虚拟地址',dataIndex:'virtualaddress',sortable:true,width:150},
				{header:'通用名称',dataIndex:'name',sortable:true,width:150}, 
				{header:'连接IP ',dataIndex:'ip',sortable:true,width:150},
			 	{header:'最后登录时间',dataIndex:'logintime',width:250}
			]);
	  
	 		reportstore=new Ext.data.SimpleStore({
			 url:'/msas/main.xp?Fun=vpnonlineuser',
             fields: [
              {name: 'virtualaddress'},
              {name: 'name'},
              {name: 'ip'},
		      		{name: 'logintime'} 
              ] 
			});   
			reportstore.load();
		
			var reportgrid=new Ext.grid.GridPanel({
				el:'reportgrid',
				ds:reportstore,
				cm:cm ,
				title:"VPN在线账号列表",
				frame:true,
				autoScroll:true,
				collapsible:true,
				height:screen.height-250,
				loadMask:{msg:'正在加载数据，请稍侯……'},
				width:screen.width-200
			});
			reportgrid.render();
	  
		  new Ext.Viewport({
								  id:'tree-xtzy-panel',
								  layout:'table',
								  defaults: {
										bodyStyle:'padding:5px 5px 5px,valign:top'
									},
								  items: [
								     reportgrid 
								  ],
								  height:screen.height-220,
								  autoScroll:true,
					        renderTo: Ext.getBody()
			});
            
      myMask.hide();
       		
});
</SCRIPT>
</head>


<body topmargin="0" leftmargin="0">
<form name="form1" method="post" action="/msas/main.xp"  target="">
<input type="hidden" name="curpage" value="1">
<table align="center"  border="0" width="100%" cellpadding="0" cellspacing="0" >

  <tbody><tr> 

      <td align="left"  valign="middle" width="100%" height="22"> 

        <table border="0" width="100%" cellspacing="0">

        <tbody><tr>

          <td> 
              <font color="#ffffff">  
               
              <div  align="left">
		  <table width=200>
		    <tr>
				<td align=left width=250><b><font color="#000000">
		  每页<input name="pagenum" value="50" size=4 class=inputf0 style="FONT-SIZE: 12px; HEIGHT: 17px;" style="text-align:center"
>条</b></font>  
		        </td>
				<td align=left width=160><b><font color="#000000">
          &nbsp;共<input name="allcount" value="200" size=4 class=inputf0 style="FONT-SIZE: 12px; HEIGHT: 17px;" style="text-align:center"
></b></font> 
		        </td>
			 </tr>
			 </table>

           </div>

            </td>

            <td> 

              <table align=right border=0 cellpadding=0 cellspacing=0 class=main width=111>

                <tbody> 

                <td width="10%"><script> 
                    
                        document.write("<img src='/images/zbuyer-06.gif' border=0 height=17 width=35 onClick='gotoPage(1);' class='hand'>");

                   </script></td>

                <td width="10%"><script>

                   
                        document.write("<img src='/images/zbuyer-03.gif' border=0 height=17 width=20 onClick='gotoPage(mypagenum-1);' class='hand'>");

                   </script></td>

                <td width="20%"><img src="/images/zbuyer-08.gif" border=0 height=17 width=32></td>

                <td align=middle background="" width=92> 

                  <input class=input id=browsdopage    name=browsdopage 0 style="FONT-SIZE: 12px; HEIGHT: 18px; WIDTH: 20px" style="text-align:center" value=1 onKeyPress="if (event.keyCode < 48 || event.keyCode > 57) event.returnValue = false;" onBlur="checkme(this)" size="2">

                </td>

                <td width="10%"><img src="/images/zbuyer-09.gif" border=0 height=17 width=16></td>

                <td width="10%"><img align=middle border=0 height=17 src="/images/zbuyer-10.gif" width=17 onClick="gotoPage(form1.browsdopage.value);" class="hand"><img align=middle height=17 src="/images/zbuyer-11.gif" width=3></td>

                <td width="10%"><script> 
                       
                            document.write("<img src='/images/zbuyer-04.gif' border=0 height=17 width=20 onClick='gotoPage(mypagenum+1);' class='hand'>");

                    </script></td>

                 <td width="10%"><script>

                        
                            document.write("<img src='/images/zbuyer-05.gif' border=0 height=17 width=36 onClick='gotoPage(parseInt((form1.allcount.value-1)/form1.pagenum.value +1));' class='hand'>");

                    </script></td> 

                </tbody> 

              </table>
            </td>

        </tr>

      </tbody></table>

    </td>

  </tr>
  </tbody></table>

 </form>

<div id="reportgrid">   
</div>
 
</body>
</html>
