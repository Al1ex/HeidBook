<HTML><HEAD><TITLE>网络7层管理和过滤的领导者</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK rel=stylesheet type=text/css href="/ext/resources/css/ext-all.css">
<LINK rel=stylesheet type=text/css href="/ext/resources/css/xtheme-default.css">
<SCRIPT type=text/javascript src="/ext/adapter/ext/ext-base.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/ext/ext-all.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/msa/publicjs/pubstyle.js"></SCRIPT>
<link rel="stylesheet" type="text/css" href="/msa/publiccss/pubcss.css">
<link rel="stylesheet" href="/msa/publiccss/css.css" type="text/css">
<SCRIPT LANGUAGE="JavaScript">
function update() {
	  var ethdevlist = new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0); 
    var ethdevMlist = new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);
    
	  var myListenchk1,myListenchk2,myListenchk3,myListenchk4;
	  var myListenchk11,myListenchk22,myListenchk33,myListenchk44;
	  var regIP=/^(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])$/;
		if(listform.Listenchk1.checked==true){
			myListenchk1=1;
			if(listform.Listen1Lan.value==-1){
	  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
	  		return false;
	  	}
			if(ethdevlist[parseInt(listform.Listen1Lan.value)]==1){
		  		Ext.MessageBox.alert('提示','网口'+ listform.Listen1Lan.value + '有重复配置！');
		  		return false;
		  }else{
		  		ethdevlist[parseInt(listform.Listen1Lan.value)]=1;
		  }
		  if(listform.Listenchk11.checked==true){
				myListenchk11=1;
				if(listform.Listen11Lan.value==-1){
		  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
		  		return false;
		  	}
				if(ethdevlist[parseInt(listform.Listen11Lan.value)]==1){
			  		Ext.MessageBox.alert('提示','网口'+ listform.Listen11Lan.value + '有重复配置！');
			  		return false;
			  }else{
			  		ethdevlist[parseInt(listform.Listen11Lan.value)]=1;
			  }
		  }else{myListenchk11=0;}
		}else{myListenchk1=0;}
		if(listform.Listenchk2.checked==true){
			myListenchk2=1;
			if(listform.Listen2Lan.value==-1){
	  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
	  		return false;
	  	}
			if(ethdevlist[parseInt(listform.Listen2Lan.value)]==1){
		  		Ext.MessageBox.alert('提示','网口'+ listform.Listen2Lan.value + '有重复配置！');
		  		return false;
		  }else{
		  		ethdevlist[parseInt(listform.Listen2Lan.value)]=1;
		  }
		  if(listform.Listenchk22.checked==true){
				myListenchk22=1;
				if(listform.Listen22Lan.value==-1){
		  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
		  		return false;
		  	}
				if(ethdevlist[parseInt(listform.Listen22Lan.value)]==1){
			  		Ext.MessageBox.alert('提示','网口'+ listform.Listen22Lan.value + '有重复配置！');
			  		return false;
			  }else{
			  		ethdevlist[parseInt(listform.Listen22Lan.value)]=1;
			  }
		  }{myListenchk22=0;}
		}else{myListenchk2=0;}
		if(listform.Listenchk3.checked==true){
			myListenchk3=1;
			if(listform.Listen3Lan.value==-1){
	  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
	  		return false;
	  	}
			if(ethdevlist[parseInt(listform.Listen3Lan.value)]==1){
		  		Ext.MessageBox.alert('提示','网口'+ listform.Listen3Lan.value + '有重复配置！');
		  		return false;
		  }else{
		  		ethdevlist[parseInt(listform.Listen3Lan.value)]=1;
		  }
		  if(listform.Listenchk33.checked==true){
				myListenchk33=1;
				if(listform.Listen33Lan.value==-1){
		  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
		  		return false;
		  	}
				if(ethdevlist[parseInt(listform.Listen33Lan.value)]==1){
			  		Ext.MessageBox.alert('提示','网口'+ listform.Listen33Lan.value + '有重复配置！');
			  		return false;
			  }else{
			  		ethdevlist[parseInt(listform.Listen33Lan.value)]=1;
			  }
		  }{myListenchk33=0;}
		}else{myListenchk3=0;}
		if(listform.Listenchk4.checked==true){
			myListenchk4=1;
			if(listform.Listen4Lan.value==-1){
	  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
	  		return false;
	  	}
			if(ethdevlist[parseInt(listform.Listen4Lan.value)]==1){
		  		Ext.MessageBox.alert('提示','网口'+ listform.Listen4Lan.value + '有重复配置！');
		  		return false;
		  }else{
		  		ethdevlist[parseInt(listform.Listen4Lan.value)]=1;
		  }
		  if(listform.Listenchk44.checked==true){
				myListenchk44=1;
				if(listform.Listen44Lan.value==-1){
		  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
		  		return false;
		  	}
				if(ethdevlist[parseInt(listform.Listen44Lan.value)]==1){
			  		Ext.MessageBox.alert('提示','网口'+ listform.Listen44Lan.value + '有重复配置！');
			  		return false;
			  }else{
			  		ethdevlist[parseInt(listform.Listen44Lan.value)]=1;
			  }
		  }{myListenchk44=0;}
		}else{myListenchk4=0;}
		if(listform.managerLan.value==-1){
  		Ext.MessageBox.alert('提示','不可配置空网口或未启用网口！');
  		return false;
  	}
  	if(ethdevlist[parseInt(listform.managerLan.value)]==1){
	  		Ext.MessageBox.alert('提示','网口'+ listform.managerLan.value + '有重复配置！');
	  		return false;
	  }else{
	  		ethdevlist[parseInt(listform.managerLan.value)]=1;
	  }
	  
  	var mymanagerIP=listform.managerIP.value;
	  if(mymanagerIP==""){	  	
	  	alert("对不起，管理口IP不能为空！");
	  	return false;
	  }else if(mymanagerIP!=""){
		  var IP_flag=false;
		  if(regIP.test(mymanagerIP)){
				IP_flag = true;
			}else{
				IP_flag = false;
			}
			if (!IP_flag){
			  alert('对不起，管理口IP地址格式错误！');
				listform.managerIP.focus();
				listform.managerIP.select();
			  return false;
			}
		}
		var myinmask=listform.inmask.value;
	  if(myinmask==""){
	  	alert("对不起，子网掩码不能为空！");
			listform.inmask.focus();
			listform.inmask.select();
	  	return false;
	  }else if(myinmask!=""){
		  var IP_flag=false;
		  if(regIP.test(myinmask)){
				IP_flag = true;
			}else{
				IP_flag = false;
			}
			if (!IP_flag){
			  alert('对不起，子网掩码格式错误！');
				listform.inmask.focus();
				listform.inmask.select();
			  return false;
			}
		}
		Ext.Ajax.request({
		    method : 'POST', 
		    url:'/msa/main.xp', 
		    success: function() { 
						Ext.MessageBox.alert('提示','旁路部署设置成功！'); 
		    },
		    failure: function() {     
		     	Ext.MessageBox.alert('提示','旁路部署设置失败！'); 
		    },
		    params:{
		      Fun:'ltsysnetconfok',actiontype:6,
		      Listen1Lan:listform.Listen1Lan.value,
		      Listen2Lan:listform.Listen2Lan.value,
		      Listen3Lan:listform.Listen3Lan.value,
		      Listen4Lan:listform.Listen4Lan.value,
		      Listen11Lan:listform.Listen11Lan.value,
		      Listen22Lan:listform.Listen22Lan.value,
		      Listen33Lan:listform.Listen33Lan.value,
		      Listen44Lan:listform.Listen44Lan.value,
		      Listenchk1:myListenchk1,
		      Listenchk2:myListenchk2,
		      Listenchk3:myListenchk3,
		      Listenchk4:myListenchk4,
		      Listenchk11:myListenchk11,
		      Listenchk22:myListenchk22,
		      Listenchk33:myListenchk33,
		      Listenchk44:myListenchk44,
		      PassAwayA:listform.PassAwayA.value,
		      PassAwayB:listform.PassAwayB.value,
		      PassAwayC:listform.PassAwayC.value,
		      PassAwayD:listform.PassAwayD.value,
		      managerLan:listform.managerLan.value,
		      managerIP:listform.managerIP.value,
		      inmask:listform.inmask.value
		    } 
		});
}
function tabfun(){
	if(listform.Listenchk1.checked==true){
		document.getElementById("Listen1Lan").disabled=false;
		document.getElementById("PassAwayA").disabled=false;
		document.getElementById("Listenchk11").disabled=false;
		if(listform.Listenchk11.checked==true){
			document.getElementById("Listen11Lan").disabled=false;
		}else{
			document.getElementById("Listen11Lan").disabled=true;
		}
	}else{
		document.getElementById("Listen1Lan").disabled=true;
		document.getElementById("PassAwayA").disabled=true;
		document.getElementById("Listenchk11").disabled=true;
		document.getElementById("Listen11Lan").disabled=true;
	}
	if(listform.Listenchk2.checked==true){
		document.getElementById("Listen2Lan").disabled=false;
		document.getElementById("PassAwayB").disabled=false;
		document.getElementById("Listenchk22").disabled=false;
		if(listform.Listenchk22.checked==true){
			document.getElementById("Listen22Lan").disabled=false;
		}else{
			document.getElementById("Listen22Lan").disabled=true;
		}
	}else{
		document.getElementById("Listen2Lan").disabled=true;
		document.getElementById("PassAwayB").disabled=true;
		document.getElementById("Listenchk22").disabled=true;
		document.getElementById("Listen22Lan").disabled=true;
	}
	if(listform.Listenchk3.checked==true){
		document.getElementById("Listen3Lan").disabled=false;
		document.getElementById("PassAwayC").disabled=false;
		document.getElementById("Listenchk33").disabled=false;
		if(listform.Listenchk33.checked==true){
			document.getElementById("Listen33Lan").disabled=false;
		}else{
			document.getElementById("Listen33Lan").disabled=true;
		}
	}else{
		document.getElementById("Listen3Lan").disabled=true;
		document.getElementById("PassAwayC").disabled=true;
		document.getElementById("Listenchk33").disabled=true;
		document.getElementById("Listen33Lan").disabled=true;
	}
	if(listform.Listenchk4.checked==true){
		document.getElementById("Listen4Lan").disabled=false;
		document.getElementById("PassAwayD").disabled=false;
		document.getElementById("Listenchk44").disabled=false;
		if(listform.Listenchk44.checked==true){
			document.getElementById("Listen44Lan").disabled=false;
		}else{
			document.getElementById("Listen44Lan").disabled=true;
		}
	}else{
		document.getElementById("Listen4Lan").disabled=true;
		document.getElementById("PassAwayD").disabled=true;
		document.getElementById("Listenchk44").disabled=true;
		document.getElementById("Listen44Lan").disabled=true;
	}
}
</SCRIPT>
<SCRIPT type="text/JavaScript">
    Ext.BLANK_IMAGE_URL = '/msa/extjs/resources/images/default/s.gif';
		Ext.onReady(function(){
	  		Ext.QuickTips.init();
				var myMask = new Ext.LoadMask(Ext.getBody(),{
				    msg:"Please wait..."
				});
				myMask.show(); 
				document.getElementById("north").style.display="";
		    new Ext.Viewport({
						layout: 'border',
						items: [{
		          region:'center',
		          contentEl: 'north',
		          autoScroll:true,
		          split:true,
		          height: 768,
		          minSize: 100,
		          maxSize: 300,
		          collapsible: false,
		          //title:'配置网络参数:旁路部署<font color="red">(不可重复配置网口)</font>',
		          margins:'0 0 0 0',
		          tbar:['->',{
		            	icon: '/msa/images/warning.gif',
									enableToggle:true,
									cls: 'x-btn-text-icon details',
		            	tooltip:{text:'<b>保存配置</b>'},
		            	text:'保存配置',
		            	iconCls:'connect',
		            	handler:function(){
		            		Ext.MessageBox.confirm('提示','您是否确定要保存当前的部署',function(button,text){
		            			if(button == 'yes'){
														update();
											}
									  })
								  }
		            },
								{
									icon: '/msa/images/warning.gif',
									enableToggle:true,
									cls: 'x-btn-text-icon details',
		            	tooltip:{text:'<b>应用该部署方式</b>'},
		            	text:'应用网口',
		            	iconCls:'connect',
		            	handler:function(){
		            		Ext.MessageBox.confirm('提示','您是否确定要应用当前的部署',function(button,text){
										   if (button == 'yes'){
											   	Ext.MessageBox.show({
																	msg: '旁路部署应用中，请稍等...',
																	progressText: 'waitting...',
																	width:300,
																	wait:true,
																	waitConfig: {interval:500},
																	icon:'ext-mb-download'
													});
											   	Ext.Ajax.request
													({
														url:'/msa/main.xp',
														params:{Fun:'msaApplyAction',deflag:'1'},
														success:function(response,options){
			                         		Ext.MessageBox.confirm('提示','网桥部署成功，您是否要到'+listform.managerIP.value+'/msa下应用新配置!',function(button,text){
																		   if (button == 'yes'){
																		   	window.open("https://"+listform.managerIP.value+"/msa", "page1", "width="+ screen.width + ",height=" + screen.height + ",top=0,left=0,toolbar=yes,menubar=yes,scrollbars=yes,resizable=yes,location=yes,status=yes,fullscreen=yes");
																		   }												  	
																	})
														},
														failure:function(){
				                           Ext.MessageBox.alert('提示','网口应用失败!');
				                    }
													});
											 }
									})
		              }
	              }
							]
		         }],
		        renderTo: Ext.getBody()
		    });
		    myMask.hide();
    });
</SCRIPT>
</head>
<body bgcolor="#f0f0f0" text="#000000" topmargin="2"  style="SCROLLBAR-FACE-COLOR: #f0f0f0;  overflow-x:hidden;  OVERFLOW: scroll; SCROLLBAR-SHADOW-COLOR: #f0f0f0; SCROLLBAR-3DLIGHT-COLOR: #f0f0f0; SCROLLBAR-ARROW-COLOR: #f0f0f0; SCROLLBAR-DARKSHADOW-COLOR: #cccccc;" onLoad="tabfun()">
<DIV id=north style="display:none">
<form name="listform" action="/msa/main.xp" method="POST">
<input type="hidden" id="nownum" value="[$nownum$]">
<table width="100%" border="0" height="100%" bgcolor="#f0f0f0" align="center">
  <tr> 
    <td valign="top"> 
	  <table width="100%" border="0" align="center" bgcolor="#f0f0f0">
	     	<tr>
		     	<td width="100%">
	    		<fieldset style="width:786" height:30;border:2px groove" align=center>
		      <legend>旁路部署</legend>
		      <table width="100%" border="0" align="center" cellpadding="1">
		        <tr> 
		          <td width="9%">监控口：</td>
		          <td width="24%">
	          	  <input type="checkbox" id="Listenchk1" name="Listenchk1" [$Listenchk1chk$] onClick="tabfun()">监控口1
	          	  <select id="Listen1Lan" name="Listen1Lan" class=inputsel>
	          	       
				          [$begintable Lanlist1$]         
				          
	          	    <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>
	          	       
				          [$endtable$]
						  	
	          	    </select>	          	  </td>
		          <td width="67%"> 虚拟通道
					        <select id="PassAwayA" name="PassAwayA" class="inputsel">
										<option value="0"[$passAway1se0$]>&nbsp;&nbsp;虚拟通道1</option>
										<option value="1"[$passAway1se1$]>&nbsp;&nbsp;虚拟通道2</option>
										<option value="2"[$passAway1se2$]>&nbsp;&nbsp;虚拟通道3</option>
										<option value="3"[$passAway1se3$]>&nbsp;&nbsp;虚拟通道4</option>
										<option value="4"[$passAway1se4$]>&nbsp;&nbsp;虚拟通道5</option>
										<option value="5"[$passAway1se5$]>&nbsp;&nbsp;虚拟通道6</option>
					</select>

								<input type="checkbox" id="Listenchk11" name="Listenchk11" [$Listenchk11chk$] onClick="tabfun()">
								数据镜像到
                  <select id="Listen11Lan" name="Listen11Lan" class=inputsel>   
				          [$begintable Lanlist11$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>					      </td>
		        </tr>
		        <tr> 
		          <td width="9%">&nbsp;</td>
		          <td width="24%">
		          	<input type="checkbox" id="Listenchk2" name="Listenchk2" [$Listenchk2chk$] onClick="tabfun()">监控口2
	          	  <select id="Listen2Lan" name="Listen2Lan" class=inputsel>   
				          [$begintable Lanlist2$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>		          </td>
		          <td width="67%"> 虚拟通道
					        <select id="PassAwayB" name="PassAwayB" class="inputsel">
										<option value="0"[$passAway2se0$]>&nbsp;&nbsp;虚拟通道1</option>
										<option value="1"[$passAway2se1$]>&nbsp;&nbsp;虚拟通道2</option>
										<option value="2"[$passAway2se2$]>&nbsp;&nbsp;虚拟通道3</option>
										<option value="3"[$passAway2se3$]>&nbsp;&nbsp;虚拟通道4</option>
										<option value="4"[$passAway2se4$]>&nbsp;&nbsp;虚拟通道5</option>
										<option value="5"[$passAway2se5$]>&nbsp;&nbsp;虚拟通道6</option>
					</select>

								<input type="checkbox" id="Listenchk22" name="Listenchk22" [$Listenchk22chk$] onClick="tabfun()">
								数据镜像到
								<select id="Listen22Lan" name="Listen22Lan" class=inputsel>   
				          [$begintable Lanlist22$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>					      </td>
		        </tr>
		        <tr> 
		          <td width="9%">&nbsp;</td>
		          <td width="24%">
		          	<input type="checkbox" id="Listenchk3" name="Listenchk3" [$Listenchk3chk$] onClick="tabfun()">监控口3
	          	  <select id="Listen3Lan" name="Listen3Lan" class=inputsel>   
				          [$begintable Lanlist3$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>		          </td>
		          <td width="67%"> 虚拟通道
					        <select id="PassAwayC" name="PassAwayC" class="inputsel">
										<option value="0"[$passAway3se0$]>&nbsp;&nbsp;虚拟通道1</option>
										<option value="1"[$passAway3se1$]>&nbsp;&nbsp;虚拟通道2</option>
										<option value="2"[$passAway3se2$]>&nbsp;&nbsp;虚拟通道3</option>
										<option value="3"[$passAway3se3$]>&nbsp;&nbsp;虚拟通道4</option>
										<option value="4"[$passAway3se4$]>&nbsp;&nbsp;虚拟通道5</option>
										<option value="5"[$passAway3se5$]>&nbsp;&nbsp;虚拟通道6</option>
					</select>

								<input type="checkbox" id="Listenchk33" name="Listenchk33" [$Listenchk33chk$] onClick="tabfun()">
								数据镜像到
                  <select id="Listen33Lan" name="Listen33Lan" class=inputsel>   
				          [$begintable Lanlist33$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>					      </td>
		        </tr>
		        <tr> 
		          <td width="9%">&nbsp;</td>
		          <td width="24%">
		          	<input type="checkbox" id="Listenchk4" name="Listenchk4" [$Listenchk4chk$] onClick="tabfun()">监控口4
	          	  <select id="Listen4Lan" name="Listen4Lan" class=inputsel>   
				          [$begintable Lanlist4$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>		          </td>
		          <td width="67%"> 虚拟通道
					        <select id="PassAwayD" name="PassAwayD" class="inputsel">
										<option value="0"[$passAway4se0$]>&nbsp;&nbsp;虚拟通道1</option>
										<option value="1"[$passAway4se1$]>&nbsp;&nbsp;虚拟通道2</option>
										<option value="2"[$passAway4se2$]>&nbsp;&nbsp;虚拟通道3</option>
										<option value="3"[$passAway4se3$]>&nbsp;&nbsp;虚拟通道4</option>
										<option value="4"[$passAway4se4$]>&nbsp;&nbsp;虚拟通道5</option>
										<option value="5"[$passAway4se5$]>&nbsp;&nbsp;虚拟通道6</option>
					</select>

								<input type="checkbox" id="Listenchk44" name="Listenchk44" [$Listenchk44chk$] onClick="tabfun()">
								数据镜像到
				  <select id="Listen44Lan" name="Listen44Lan" class=inputsel>   
				          [$begintable Lanlist44$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  	</select>					      </td>
		        </tr>
		      
		        <tr> 
		          <td width="9%">管理口：</td>
		          <td colspan="2"> 
		          <select id="managerLan" name="managerLan" class=inputsel>   
				          [$begintable Lanlist5$]         
				          <option value="[$vlanid$]" [$selvid$] >eth[$vlanid$]</option>   
				          [$endtable$]
						  </select>		          </td>
		        </tr>
		        
		        <tr> 
		          <td width="9%">管理IP：</td>
		          <td colspan="2"> 
		          <input type="text" name="managerIP" value="[$managerIP$]"  class="input" >		          </td>
		        </tr>
		        
		        <tr> 
		          <td width="9%">子网掩码</td>
		          <td colspan="2"> 
	              <input type="text" name="inmask" value="[$inmask$]"  class="input" >		             </td>
		        </tr>
        	</table>
					</fieldset>
		  
		  
		     	<table width="100%" border="0" align="center">
			     	<tr>
				     	<td>
				         <fieldset style="width:786" height:30;border:2px groove" align=center>
				          <legend>图例</legend> 
				          <table width="100%" border="0" align="center">
							        <tr> 
							          <td width="25%"> 
							          <img src="/msa/images/connect5tmp.jpg" width="680">	
							          </td>
							        </tr>
					  	 		</table>
						  	</fieldset>
					  	</td>
				  	</tr>
					</table> 
    			</td>
  			</tr> 
		</table>
		</td>
	</tr>
</table>
</form>
</DIV>
</body>
</html>
