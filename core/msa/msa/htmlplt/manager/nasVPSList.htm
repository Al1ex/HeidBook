<HTML><HEAD><TITLE>网络7层管理和过滤的领导者</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK rel=stylesheet type=text/css href="/ext/resources/css/ext-all.css">
<LINK rel=stylesheet type=text/css href="/ext/resources/css/xtheme-default.css">
<SCRIPT type=text/javascript src="/ext/adapter/ext/ext-base.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/ext/ext-all.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/msa/publicjs/pubstyle.js"></SCRIPT>
<link rel="stylesheet" type="text/css" href="/msa/publiccss/pubcss.css">
<link rel="stylesheet" href="/msa/publiccss/css.css" type="text/css">

<script language="javascript">
function funClear(){
	 var txts=document.getElementsByTagName("input"); 
	 for(var i=0;i <txts.length;i++){ 
	  if(txts[i].type=="text"){ 
	   txts[i].value =""; 
	   txts[i].checked ="false"; 
	  } 
	 }
	 for(var j=0;j <txts.length;j++){ 
	  if(txts[j].type=="checkbox"){ 
	   txts[j].checked =false; 
	  } 
	 }
}
function addjjr(){
		var myLan1=listform.LAN1.value;
		var myLan2=listform.LAN2.value;
		var myLan3=listform.LAN3.value;
		var myLan4=listform.LAN4.value;
		var myLan5=listform.LAN5.value;
		var myLan6=listform.LAN6.value;
		var myLan7=listform.LAN7.value;
		var myLan8=listform.LAN8.value;
		if(myLan1>=listform.nownum.value||myLan2>=listform.nownum.value||myLan3>=listform.nownum.value||myLan4>=listform.nownum.value||myLan5>=listform.nownum.value||myLan6>=listform.nownum.value||myLan7>=listform.nownum.value||myLan8>=listform.nownum.value){
			Ext.MessageBox.alert("提示","现在只启用了"+listform.nownum.value+"个网口,请检查您是否配置了未启用的网口");
			return false;
		}
		
		
	 var mytxtIp;
	 var regIP=/^(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])$/;
   var IP_flag=false;
	 for(var i=1;i<9;i++){
	 	mytxtIp='txtIp'+i;
	 	if(document.getElementById(mytxtIp).value!=""){
		 	 if(regIP.test(document.getElementById(mytxtIp).value)){
					IP_flag = true;
			 }else{
					IP_flag = false;
			 }
			
			 if (!IP_flag){
				  alert("对不起，ID为"+i+"的IP地址格式错误!");
					document.getElementById(mytxtIp).focus();
					document.getElementById(mytxtIp).select();
				  return false;
			 }
		}
	 }
	 for(var i=1;i<9;i++){
	 	mytxtIp='txtIp'+i+i;
	 	if(document.getElementById(mytxtIp).value!=""){
		 	 if(regIP.test(document.getElementById(mytxtIp).value)){
					IP_flag = true;
			 }else{
					IP_flag = false;
			 }
			
			 if (!IP_flag){
				  alert("对不起，ID为"+i+"的映射IP地址格式错误!");
					document.getElementById(mytxtIp).focus();
					document.getElementById(mytxtIp).select();
				  return false;
			 }
		}
	 }
	 for(var i=1;i<9;i++){
		 	myLAN='txtLan'+i+i;
		 	if(!(document.getElementById(myLAN).value>=0&&document.getElementById(myLAN).value<=65535)){
				  alert("对不起，服务端口必须在0~65535之间,ID为"+i+"的映射IP地址格式错误!");
					document.getElementById(myLAN).focus();
					document.getElementById(myLAN).select();
				return false;
			}
	 }
		
		var myenable1,myenable2,myenable3,myenable4,myenable5,myenable6,myenable7,myenable8;
   	if(document.getElementById('enable1').checked){myenable1=1;}else{myenable1=0;}
   	if(document.getElementById('enable2').checked){myenable2=1;}else{myenable2=0;}
   	if(document.getElementById('enable3').checked){myenable3=1;}else{myenable3=0;}
   	if(document.getElementById('enable4').checked){myenable4=1;}else{myenable4=0;}
   	if(document.getElementById('enable5').checked){myenable5=1;}else{myenable5=0;}
   	if(document.getElementById('enable6').checked){myenable6=1;}else{myenable6=0;}
   	if(document.getElementById('enable7').checked){myenable7=1;}else{myenable7=0;}
   	if(document.getElementById('enable8').checked){myenable8=1;}else{myenable8=0;}
   	var mytxtIp11,mytxtIp22,mytxtIp33,mytxtIp44,mytxtIp55,mytxtIp66,mytxtIp77,mytxtIp88;
   	var mytxtIp1,mytxtIp2,mytxtIp3,mytxtIp4,mytxtIp5,mytxtIp6,mytxtIp7,mytxtIp8;
   	mytxtIp11=document.getElementById('txtIp11').value;
	  mytxtIp22=document.getElementById('txtIp22').value;
	  mytxtIp33=document.getElementById('txtIp33').value;
	  mytxtIp44=document.getElementById('txtIp44').value;
	  mytxtIp55=document.getElementById('txtIp55').value;
	  mytxtIp66=document.getElementById('txtIp66').value;
	  mytxtIp77=document.getElementById('txtIp77').value;
	  mytxtIp88=document.getElementById('txtIp88').value;
	  mylan11=document.getElementById('txtLan11').value;
	  mylan22=document.getElementById('txtLan22').value;
	  mylan33=document.getElementById('txtLan33').value;
	  mylan44=document.getElementById('txtLan44').value;
	  mylan55=document.getElementById('txtLan55').value;
	  mylan66=document.getElementById('txtLan66').value;
	  mylan77=document.getElementById('txtLan77').value;
	  mylan88=document.getElementById('txtLan88').value;
	  mytxtIp1=document.getElementById('txtIp1').value;
	  mytxtIp2=document.getElementById('txtIp2').value;
	  mytxtIp3=document.getElementById('txtIp3').value;
	  mytxtIp4=document.getElementById('txtIp4').value;
	  mytxtIp5=document.getElementById('txtIp5').value;
	  mytxtIp6=document.getElementById('txtIp6').value;
	  mytxtIp7=document.getElementById('txtIp7').value;
	  mytxtIp8=document.getElementById('txtIp8').value;
	  mypro1=document.getElementById('pro1').value;
	  mypro2=document.getElementById('pro2').value;
	  mypro3=document.getElementById('pro3').value;
	  mypro4=document.getElementById('pro4').value;
	  mypro5=document.getElementById('pro5').value;
	  mypro6=document.getElementById('pro6').value;
	  mypro7=document.getElementById('pro7').value;
	  mypro8=document.getElementById('pro8').value;
	  
	  Ext.Ajax.request({
			    method : 'POST', 
			    url:'/msa/main.xp', 
			    success: function(){ 
						Ext.MessageBox.alert('提示','虚拟服务器参数配置成功！'); 
			    },
			    failure: function(){     
			     	Ext.MessageBox.alert('提示','虚拟服务器参数配置失败！'); 
			    },
			    params:{
			      Fun:'ltVPSok',
			      enable1:myenable1,
			      enable2:myenable2,
			      enable3:myenable3,
			      enable4:myenable4,
			      enable5:myenable5,
			      enable6:myenable6,
			      enable7:myenable7,
			      enable8:myenable8,
			      Lan1:myLan1,
			      Lan2:myLan2,
			      Lan3:myLan3,
			      Lan4:myLan4,
			      Lan5:myLan5,
			      Lan6:myLan6,
			      Lan7:myLan7,
			      Lan8:myLan8,
			      txtIp11:mytxtIp11,
			      txtIp22:mytxtIp22,
			      txtIp33:mytxtIp33,
			      txtIp44:mytxtIp44,
			      txtIp55:mytxtIp55,
			      txtIp66:mytxtIp66,
			      txtIp77:mytxtIp77,
			      txtIp88:mytxtIp88,
			      lan11:mylan11,
			      lan22:mylan22,
			      lan33:mylan33,
			      lan44:mylan44,
			      lan55:mylan55,
			      lan66:mylan66,
			      lan77:mylan77,
			      lan88:mylan88,
			      txtIp1:mytxtIp1,
			      txtIp2:mytxtIp2,
			      txtIp3:mytxtIp3,
			      txtIp4:mytxtIp4,
			      txtIp5:mytxtIp5,
			      txtIp6:mytxtIp6,
			      txtIp7:mytxtIp7,
			      txtIp8:mytxtIp8,
			      pro1:mypro1,
			      pro2:mypro2,
			      pro3:mypro3,
			      pro4:mypro4,
			      pro5:mypro5,
			      pro6:mypro6,
			      pro7:mypro7,
			      pro8:mypro8
			    } 
		});
}
</script>
</head>
<body bgcolor="#f0f0f0" text="#000000" link="#C0C0C0">
<form name="listform" method="post" action="/msa/main.xp" >
<input type="hidden" name="nownum" value="[$nownum$]">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<fieldset style="width:90%;height:30;border:2px groove" align=center>
		<legend>参数设定</legend> 
	  <table width='90%' height="303" align="center" style="gray">
		<tr><td colspan="7">虚拟服务器，简单地说，您可以做这么样的指定：对宝创MSA任何一个或一段协议端口的访问(从WAN口进来的访问)，都可以重定位到局域网内某一台指定的网络服务器。</td></tr>
		<tr>
		  <td width="11%" align="center">ID</td>
		  <td width="11%">接入网口</td>
		  <td width="19%">映射公网IP地址</td>
		  <td width="15%">服务端口</td>
		  <td width="19%">内部IP地址</td>
		  <td width="13%">协议</td>
		  <td width="12%">启用</td>
		</tr>
		<tr>
		  <td align="center">1</td>
		  <td>
		  	<select name="LAN1" class=inputsel>
			  	<option value="0" [$LAN10$]>eth0</option>
			  	<option value="1" [$LAN11$]>eth1</option>
			  	<option value="2" [$LAN12$]>eth2</option>
			  	<option value="3" [$LAN13$]>eth3</option>
			  	<option value="4" [$LAN14$]>eth4</option>
			  	<option value="5" [$LAN15$]>eth5</option>
			  	<option value="6" [$LAN16$]>eth6</option>
			  	<option value="7" [$LAN17$]>eth7</option>
			  	<option value="8" [$LAN18$]>eth8</option>
			  	<option value="9" [$LAN19$]>eth9</option>
		    </select>
		  </td>
		  <td><input id="txtIp11" name="txtIp11" class="input" value="[$ip11$]" size="15"></td>
		  <td><input id="txtLan11" name="txtLan11" class="input" value="[$lan11$]" size="10"></td>
		  <td><input id="txtIp1" name="txtIp1" class="input" value="[$ip1$]" size="15"></td>
		  <td>
				<select name="pro1" class=inputsel>
					<option value=-1 [$pro1-1$]>ALL</option>
					<option value=0 [$pro10$]>UDP</option>
					<option value=1 [$pro11$]>TCP</option>
				</select>	  </td>
		  <td><input type="checkbox" id="enable1" name="enable1" value="1" [$enablechk1$] ></td>
		</tr>
		<tr>
		  <td align="center">2</td>
		  <td>
		  	<select name="LAN2" class=inputsel>
			  	<option value="0" [$LAN20$]>eth0</option>
			  	<option value="1" [$LAN21$]>eth1</option>
			  	<option value="2" [$LAN22$]>eth2</option>
			  	<option value="3" [$LAN23$]>eth3</option>
			  	<option value="4" [$LAN24$]>eth4</option>
			  	<option value="5" [$LAN25$]>eth5</option>
			  	<option value="6" [$LAN26$]>eth6</option>
			  	<option value="7" [$LAN27$]>eth7</option>
			  	<option value="8" [$LAN28$]>eth8</option>
			  	<option value="9" [$LAN29$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp22" name="txtIp22" class="input" value="[$ip22$]" size="15"></td>
		  <td><input id="txtLan22" name="txtLan22" class="input" value="[$lan22$]" size="10"></td>
		  <td><input id="txtIp2" name="txtIp2" class="input" value="[$ip2$]" size="15"></td>
		  <td>
				<select name="pro2" class=inputsel>
					<option value=-1 [$pro2-1$]>ALL</option>
					<option value=0 [$pro20$]>UDP</option>
					<option value=1 [$pro21$]>TCP</option>
				</select>	  </td>
		  <td><input type="checkbox" id="enable2" name="enable2" value="1" [$enablechk2$] ></td>
		</tr>
		<tr>
		  <td align="center">3</td>
		  <td><select name="LAN3" class=inputsel>
			  	<option value="0" [$LAN30$]>eth0</option>
			  	<option value="1" [$LAN31$]>eth1</option>
			  	<option value="2" [$LAN32$]>eth2</option>
			  	<option value="3" [$LAN33$]>eth3</option>
			  	<option value="4" [$LAN34$]>eth4</option>
			  	<option value="5" [$LAN35$]>eth5</option>
			  	<option value="6" [$LAN36$]>eth6</option>
			  	<option value="7" [$LAN37$]>eth7</option>
			  	<option value="8" [$LAN38$]>eth8</option>
			  	<option value="9" [$LAN39$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp33" name="txtIp33" class="input" value="[$ip33$]" size="15"></td>
		  <td><input id="txtLan33" name="txtLan33" class="input" value="[$lan33$]" size="10"></td><td>
		      <input id="txtLan3" name="txtIp3" class="input" value="[$ip3$]" size="15"></td>
		  <td>
				<select name="pro3" class=inputsel>
					<option value=-1 [$pro3-1$]>ALL</option>
					<option value=0 [$pro30$]>UDP</option>
					<option value=1 [$pro31$]>TCP</option>
				</select>    </td>
		  <td><input type="checkbox" id="enable3" name="enable3" value="1" [$enablechk3$] ></td>
		</tr>
		<tr>
			<td align="center">4</td>
		  <td><select name="LAN4" class=inputsel>
			  	<option value="0" [$LAN40$]>eth0</option>
			  	<option value="1" [$LAN41$]>eth1</option>
			  	<option value="2" [$LAN42$]>eth2</option>
			  	<option value="3" [$LAN43$]>eth3</option>
			  	<option value="4" [$LAN44$]>eth4</option>
			  	<option value="5" [$LAN45$]>eth5</option>
			  	<option value="6" [$LAN46$]>eth6</option>
			  	<option value="7" [$LAN47$]>eth7</option>
			  	<option value="8" [$LAN48$]>eth8</option>
			  	<option value="9" [$LAN49$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp44" name="txtIp44" class="input" value="[$ip44$]" size="15"></td>
		  <td><input id="txtLan44" name="txtLan44" class="input" value="[$lan44$]" size="10"></td><td>
		      <input id="txtIp4" name="txtIp4" class="input" value="[$ip4$]" size="15"></td>
		  <td>
				<select name="pro4" class=inputsel>
					<option value=-1 [$pro4-1$]>ALL</option>
					<option value=0 [$pro40$]>UDP</option>
					<option value=1 [$pro41$]>TCP</option>
				</select>    </td>
		  <td><input type="checkbox" id="enable4" name="enable4" value="1" [$enablechk4$] ></td>
		</tr>
		<tr>
			<td align="center">5</td>
		  <td><select name="LAN5" class=inputsel>
			  	<option value="0" [$LAN50$]>eth0</option>
			  	<option value="1" [$LAN51$]>eth1</option>
			  	<option value="2" [$LAN52$]>eth2</option>
			  	<option value="3" [$LAN53$]>eth3</option>
			  	<option value="4" [$LAN54$]>eth4</option>
			  	<option value="5" [$LAN55$]>eth5</option>
			  	<option value="6" [$LAN56$]>eth6</option>
			  	<option value="7" [$LAN57$]>eth7</option>
			  	<option value="8" [$LAN58$]>eth8</option>
			  	<option value="9" [$LAN59$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp55" name="txtIp55" class="input" value="[$ip55$]" size="15"></td>
		  <td><input id="txtLan55" name="txtLan55" class="input" value="[$lan55$]" size="10"></td><td>
		      <input id="txtIp5" name="txtIp5" class="input" value="[$ip5$]" size="15"></td>
		  <td>
				<select name="pro5" class=inputsel>
					<option value=-1 [$pro5-1$]>ALL</option>
					<option value=0 [$pro50$]>UDP</option>
					<option value=1 [$pro51$]>TCP</option>
				</select>    </td>
		  <td><input type="checkbox" id="enable5" name="enable5" value="1" [$enablechk5$] ></td>
		</tr>
		<tr>
			<td align="center">6</td>
		  <td><select name="LAN6" class=inputsel>
			  	<option value="0" [$LAN60$]>eth0</option>
			  	<option value="1" [$LAN61$]>eth1</option>
			  	<option value="2" [$LAN62$]>eth2</option>
			  	<option value="3" [$LAN63$]>eth3</option>
			  	<option value="4" [$LAN64$]>eth4</option>
			  	<option value="5" [$LAN65$]>eth5</option>
			  	<option value="6" [$LAN66$]>eth6</option>
			  	<option value="7" [$LAN67$]>eth7</option>
			  	<option value="8" [$LAN68$]>eth8</option>
			  	<option value="9" [$LAN69$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp66" name="txtIp66" class="input" value="[$ip66$]" size="15"></td>
		  <td><input id="txtLan66" name="txtLan66" class="input" value="[$lan66$]" size="10"></td><td>
		      <input id="txtIp6" name="txtIp6" class="input" value="[$ip6$]" size="15"></td>
		  <td>
				<select name="pro6" class=inputsel>
					<option value=-1 [$pro6-1$]>ALL</option>
					<option value=0 [$pro60$]>UDP</option>
					<option value=1 [$pro61$]>TCP</option>
				</select>    </td>
		  <td><input type="checkbox" id="enable6" name="enable6" value="1" [$enablechk6$] ></td>
		</tr>
		<tr>
			<td align="center">7</td>
		  <td><select name="LAN7" class=inputsel>
			  	<option value="0" [$LAN70$]>eth0</option>
			  	<option value="1" [$LAN71$]>eth1</option>
			  	<option value="2" [$LAN72$]>eth2</option>
			  	<option value="3" [$LAN73$]>eth3</option>
			  	<option value="4" [$LAN74$]>eth4</option>
			  	<option value="5" [$LAN75$]>eth5</option>
			  	<option value="6" [$LAN76$]>eth6</option>
			  	<option value="7" [$LAN77$]>eth7</option>
			  	<option value="8" [$LAN78$]>eth8</option>
			  	<option value="9" [$LAN79$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp77" name="txtIp77" class="input" value="[$ip77$]" size="15"></td>
		  <td><input id="txtLan77" name="txtLan77" class="input" value="[$lan77$]" size="10"></td><td>
		      <input id="txtIp7" name="txtIp7" class="input" value="[$ip7$]" size="15"></td>
		  <td>
				<select name="pro7" class=inputsel>
					<option value=-1 [$pro7-1$]>ALL</option>
					<option value=0 [$pro70$]>UDP</option>
					<option value=1 [$pro71$]>TCP</option>
				</select>    </td>
		  <td><input type="checkbox" id="enable7" name="enable7" value="1" [$enablechk7$] ></td>
		</tr>
		<tr>
			<td align="center">8</td>
		  <td><select name="LAN8" class=inputsel>
			  	<option value="0" [$LAN80$]>eth0</option>
			  	<option value="1" [$LAN81$]>eth1</option>
			  	<option value="2" [$LAN82$]>eth2</option>
			  	<option value="3" [$LAN83$]>eth3</option>
			  	<option value="4" [$LAN84$]>eth4</option>
			  	<option value="5" [$LAN85$]>eth5</option>
			  	<option value="6" [$LAN86$]>eth6</option>
			  	<option value="7" [$LAN87$]>eth7</option>
			  	<option value="8" [$LAN88$]>eth8</option>
			  	<option value="9" [$LAN89$]>eth9</option>
		    </select></td>
		  <td><input id="txtIp88" name="txtIp88" class="input" value="[$ip88$]" size="15"></td>
		  <td><input id="txtLan88" name="txtLan88" class="input" value="[$lan88$]" size="10"></td><td>
		      <input id="txtIp8" name="txtIp8" class="input" value="[$ip8$]" size="15"></td>
		  <td>
				<select name="pro8" class=inputsel>
					<option value=-1 [$pro8-1$]>ALL</option>
					<option value=0 [$pro80$]>UDP</option>
					<option value=1 [$pro81$]>TCP</option>
				</select>    </td>
		  <td><input type="checkbox" id="enable8" name="enable8" value="1" [$enablechk8$] ></td>
		</tr>
		</table>
	</fieldset>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	<fieldset style="width:90%;height:30;border:2px groove" align=center>
		<table width='82%' align="center" style="gray">
			<tr>
				<td colspan="7" height="31">
			  <input type='button'  name='btnReset' value='清 空' class="input" onClick="funClear()">
			  &nbsp;&nbsp;
				<input type='button'  name='btnSub' value='保 存' class="input" onClick="addjjr()"></td>
		  </tr>
		</table>
	</fieldset>
</form>
</body>
</html>
