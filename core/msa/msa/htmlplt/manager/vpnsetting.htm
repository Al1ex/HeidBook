<html>
<head>
<title>VPN参数配置</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<LINK rel=stylesheet type=text/css href="/ext/resources/css/ext-all.css">
<LINK rel=stylesheet type=text/css href="/ext/resources/css/xtheme-default.css">
<SCRIPT type=text/javascript src="/ext/adapter/ext/ext-base.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/ext/ext-all.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/msa/publicjs/pubstyle.js"></SCRIPT>
<link rel="stylesheet" type="text/css" href="/msa/publiccss/pubcss.css">
<SCRIPT LANGUAGE="JavaScript"> 
	Ext.BLANK_IMAGE_URL = '/msa/extjs/resources/images/default/s.gif'; 
	Ext.onReady(function(){
		var wing3;
		var panel3 =new Ext.Panel({
				layout:'fit',
				height:300,
				autoScroll: false,
				contentEl:'additive3'
		});
		var button_3 = Ext.get('Service_3');
		button_3.on('click', function(){
				if(!wing3){
				wing3 = new Ext.Window({
						title: '设置附加路由',
						closeAction: 'hide',
						width: 450,
						height:330,
						plain:true,
						autoScroll:false,
						items:panel3,
						bodyStyle:'padding:5px;',
						buttons: [{
		                text: '保存设置',
					   	   handler: function(){
									wing3.hide();
								 }
						}]
					});
				}
				wing3.show();
		});
	});
</SCRIPT>

<SCRIPT LANGUAGE="JavaScript">
	
	function allChecked(id){
		  var  dfd=eval("document.all.dfd" + id);
		  var  DataTable=eval("document.all.DataTable" + id);
	    if(dfd.value=="1"){
	        dfd.value="0";
	    }else{
	        dfd.value="1";
	    }
	    
		for(var i=0;i<DataTable.rows.length;i++)
		{ //alert(i);
			if(typeof(DataTable.rows[i].cells[0].childNodes[1])=="object"
	
					&&DataTable.rows[i].cells[0].childNodes[1].tagName=="INPUT"
	
					&&DataTable.rows[i].cells[0].childNodes[1].type=="checkbox") {
				if(dfd.value=="1"){
	  			    DataTable.rows[i].cells[0].childNodes[1].checked="true";
	            }
				else{
	                DataTable.rows[i].cells[0].childNodes[1].checked="";
	            }
	        }
	 	}
	}
	function sub(){
	    var ENABLEVPNvar;
	    ENABLEVPNvar="NO";
	    if(document.getElementById("ENABLEVPN").checked==true){
	      ENABLEVPNvar="YES";
	    }
	    var port=document.getElementById("port").value;
	    var sever=document.getElementById("sever").value;
	    var ip=document.getElementById("ip").value;
	    var ipmask=document.getElementById("ipmask").value;
	    var routip1=document.getElementById("routip1").value;
		  var routmask1=document.getElementById("routmask1").value;
		  
		  var routip2=document.getElementById("routip2").value;
		  var routmask2=document.getElementById("routmask2").value;
		  
		  var routip3=document.getElementById("routip3").value;
		  var routmask3=document.getElementById("routmask3").value;
		  
		  var routip4=document.getElementById("routip4").value;
		  var routmask4=document.getElementById("routmask4").value;
		  
		  var routip5=document.getElementById("routip5").value;
		  var routmask5=document.getElementById("routmask5").value;
		  
		  var routip6=document.getElementById("routip6").value;
		  var routmask6=document.getElementById("routmask6").value;
	
	    
	    if(port==""){
	    	alert("请填写端口号！");return ;
	    }if(sever==""){
	    	alert("请填写服务器类型！");return ;
	    }if(ip==""){
	    	alert("请填写服务器IP！");return ;
	    }if(ipmask==""){
	    	alert("请填写网桥掩码！");return ;
	    }if(routip1==""){
	    	alert("请填写路由地址！");return ;
	    }if(routmask1==""){
	    	alert("请填写子网掩码！");return ;
	    } 
	    
	    
			Ext.Ajax.request({
			    method : 'POST', 
			    url:'/msa/main.xp', 
			    success: function() { 
			     	//Ext.MessageBox.alert('提示','VPN参数设置成功！');
			    	location.href='/msa/main.xp?Fun=tovpnsetting';
			    },
			    failure: function() {     
			     	Ext.MessageBox.alert('提示','VPN参数设置失败！'); 
			    },
			    params:{
			      Fun:'vpnsetting',
			      ENABLEVPN:ENABLEVPNvar,
			      port:port,
			      sever:sever,
			      ip:ip,
			      ipmask:ipmask,
			      routip1:routip1,
			      routmask1:routmask1,
			      routip2:routip2,
			      routmask2:routmask2,
			      routip3:routip3,
			      routmask3:routmask3,
			      routip4:routip4,
			      routmask4:routmask4,
			      routip5:routip5,
			      routmask5:routmask5,
			      routip6:routip6,
			      routmask6:routmask6
			    } 
			}); 
	
	    //document.getElementById("form1").submit();
	 
	}	
</SCRIPT>

</head> 
<body oncontextmenu="return false" bgcolor="#f0f0f0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" >
  <tr> 
    <td> 
     <form name="form1" id="form1" method="post"  action="/msa/main.xp" >  
	    <input type="hidden" name="Fun" value="vpnsetting">
	 		<TABLE width="100%" border="0" cellspacing="0" cellpadding="0" >
          <div id="plabel"> 
			 			<tr> 
             <td width="50" height="30"> 
                <div align="center">&nbsp;</div>
             </td>
             <td> 
                <div align="left">是否启动 :  &nbsp;&nbsp;
                <input type='checkbox' name='ENABLEVPN' value="YES" [$echecked$] >
              	</div>
             </td>
        		</tr> 
			
		   			<tr> 
             <td width="50" height="30"> 
                <div align="center">&nbsp;</div>
             </td>
             <td> 
                <div align="left">端  口  号  :  &nbsp;&nbsp;
               	<input type="text"  class=inputf0 name="port" size="12" maxlength="32" value="[$port$]"  >  
              	</div>
             </td>
            </tr> 

			 			<tr> 
             	<td width="50" height="30"> 
                <div align="center">&nbsp;</div>
              </td>
              <td> 
                <div align="left">服务器类型:&nbsp;&nbsp;                      
                 <select name="sever"  class=inputself0 >
                   <option value="tcp" [$se1$]>TCP server</option>
                   <option value="udp" [$se2$]>UDP server</option>
              	 </select>
              	</div>
              </td>
            </tr> 

             
            <tr> 
              <td width="50" > 
                <div align="center">&nbsp;</div>
              </td>
              <td> 
                <div align="left">VPN地址池:&nbsp;网段&nbsp;                  
          			<input type="text"  class=inputf0 name="ip" size="15" maxlength="32" value="[$ip$]"  >  
            			掩码  &nbsp;<input type="text"  class=inputf0 name="ipmask" size="15" maxlength="32" value="[$ipmask$]"  >
               	</div>
              </td>
            </tr> 


		    		<tr> 
              <td width="50" height="30"  > 
                <div align="center">&nbsp;</div>
              </td>  
              <td  height="35"  > 
                <div align="left"> 
                	<input type="button" name="Service_3" id="Service_3" class="inputf0" border="0" value="设置vpn客户端经vpn的附加路由" >
								</div>
              </td>
           	</tr> 
           	
            <tr> 
              <td height="50">&nbsp;</td>
              <td height="30">
              <hr>
              <input type="button"  border="0"  class=inputf0 value="确定提交" onClick="sub();" > 
              </td>
            </tr>
 
          </div>
      </TABLE>
      <div style='DISPLAY:none' additive>
			<div id="additive3" >	
				<table height="100" border="0" align="left">
					<tr>  
					  <td  height="25"  > 
					    <div align="center"> 
					       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;网段
							</div>
					  </td>
					  <td  height="25"  > 
					    <div align="center"> 
					       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;子网掩码
							</div>
					  </td>
					</tr> 
					 
					<tr>
					  <td height="25" colspan="2"> 
					    <div align="left"> 
					       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					        <input type="text"  class=inputf0 name="routip1" size="15" maxlength="32" value="[$routip1$]"  >  &nbsp;&nbsp; 
					 				<input type="text"  class=inputf0 name="routmask1" size="15" maxlength="32" value="[$routmask1$]"  >
					  	</div>
					  </td>
					</tr>
					
					<tr>
					  <td height="25" colspan="2"> 
					    <div align="left"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					       <input type="text"  class=inputf0 name="routip2" size="15" maxlength="32" value="[$routip2$]"  >  &nbsp;&nbsp; 
					 			 <input type="text"  class=inputf0 name="routmask2" size="15" maxlength="32" value="[$routmask2$]"  >
					  	</div>
					  </td>
					</tr>
					
					<tr>
					  <td height="35" colspan="2"> 
					    <div align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					      <input type="text"  class=inputf0 name="routip3" size="15" maxlength="32" value="[$routip3$]"  >  &nbsp;&nbsp; 
					 			<input type="text"  class=inputf0 name="routmask3" size="15" maxlength="32" value="[$routmask3$]"  >
					  	</div>
					  </td>
					</tr>
					
					<tr>
					  <td height="35" colspan="2"> 
					    <div align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					       <input type="text"  class=inputf0 name="routip4" size="15" maxlength="32" value="[$routip4$]" >  &nbsp;&nbsp; 
					 			 <input type="text"  class=inputf0 name="routmask4" size="15" maxlength="32" value="[$routmask4$]"  >
					  	</div>
					  </td>
					</tr>
					
					<tr>
					  <td height="35" colspan="2"> 
					    <div align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					       <input type="text"  class=inputf0 name="routip5" size="15" maxlength="32" value="[$routip5$]"  >  &nbsp;&nbsp; 
					 			 <input type="text"  class=inputf0 name="routmask5" size="15" maxlength="32" value="[$routmask5$]"  >
					  	</div>
					  </td>
					</tr>
					
					<tr>
					  <td height="35" colspan="2"> 
					    <div align="left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
					       <input type="text"  class=inputf0 name="routip6" size="15" maxlength="32" value="[$routip6$]"  >  &nbsp;&nbsp; 
					 			 <input type="text"  class=inputf0 name="routmask6" size="15" maxlength="32" value="[$routmask6$]"  >
					  	</div>
					  </td>
					</tr>
				</div>
			</div>
			</div> 
     </form>
    </td>
  </tr>
</table>
</body>
</html>
