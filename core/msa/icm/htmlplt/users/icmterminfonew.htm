<html>
<head>
<title>用户编辑</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<META HTTP-EQUIV="Expires" CONTENT="0">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Jon Eyrick" CONTENT="no-cache">
<link rel="stylesheet" href="/icm/publiccss/pubcss.css" type="text/css">
<script type=text/javascript  src="/icm/publicjs/select_time_st.js"></script>
<style>
.conts{visibility:hidden}
.tab{
	border-top:thin solid #FFFFFF;
	border-right:thin solid gray;
	border-left:thin solid #FFFFFF;
	font-family:Verdana;
	font-size:10pt;
	text-align:center;
	font-weight:normal;
	border-bottom-width: thin;
	border-bottom-style: double;
	border-bottom-color: gray;
}
.tab1{
	border-top:thin none #FFFFFF;
	border-right:thin solid gray;
	border-left:thin none #FFFFFF;
	font-family:Verdana;
	font-size:10pt;
	text-align:center;
	font-weight:normal;
	border-bottom-width: thin;
	border-bottom-style: none;
	border-bottom-color: gray;
}
.selTab{border-left:solid thin white;
border-top:solid thin white;
border-right:solid thin black;
font-weight:bold;
text-align:center}
</style>
<script language="javascript">

function goto(o){
window.open(o,"_self","")
}

</script>
<script language = "Javascript" src = "/publicjs/selecttime.js"></script>
<script LANGUAGE="JavaScript">
//this is the tab switching function
var currentTab;
var tabBase;
var firstFlag = true;

function changeTabs(){
if(firstFlag == true){
currentTab = t0;
tabBase = t0base;
firstFlag = false;
}
if(window.event.srcElement.className == "tab"){
currentTab.className = "tab";
tabBase.style.backgroundColor = "white";
currentTab = window.event.srcElement;
tabBaseID = currentTab.id + "base";
tabContentID = currentTab.id + "Contents";
tabBase = document.all(tabBaseID);
tabContent = document.all(tabContentID);
currentTab.className = "selTab";
tabBase.style.backgroundColor = "";
//tabContents.innerHTML = tabContent.innerHTML;
if(tabContent.id=="t0Contents"){
listform.all.xxx.all.as0.style.display=""
listform.all.xxx.all.as1.style.display="none"
listform.all.xxx.all.as2.style.display="none"
listform.all.xxx.all.as3.style.display="none"
listform.all.xxx.all.as4.style.display="none"
listform.all.xxx.all.as5.style.display="none"
listform.all.xxx.all.as6.style.display="none"
}
else if(tabContent.id=="t1Contents"){
listform.all.xxx.all.as0.style.display="none"
listform.all.xxx.all.as1.style.display=""
listform.all.xxx.all.as2.style.display="none"
listform.all.xxx.all.as3.style.display="none"
listform.all.xxx.all.as4.style.display="none"
listform.all.xxx.all.as5.style.display="none"
listform.all.xxx.all.as6.style.display="none"
}
else if(tabContent.id=="t2Contents"){
listform.all.xxx.all.as0.style.display="none"
listform.all.xxx.all.as1.style.display="none"
listform.all.xxx.all.as2.style.display=""
listform.all.xxx.all.as3.style.display="none"
listform.all.xxx.all.as4.style.display="none"
listform.all.xxx.all.as5.style.display="none"
listform.all.xxx.all.as6.style.display="none"
}
else if(tabContent.id=="t3Contents"){
listform.all.xxx.all.as0.style.display="none"
listform.all.xxx.all.as1.style.display="none"
listform.all.xxx.all.as2.style.display="none"
listform.all.xxx.all.as3.style.display=""
listform.all.xxx.all.as4.style.display="none"
listform.all.xxx.all.as5.style.display="none"
listform.all.xxx.all.as6.style.display="none"
}
else if(tabContent.id=="t4Contents"){
listform.all.xxx.all.as0.style.display="none"
listform.all.xxx.all.as1.style.display="none"
listform.all.xxx.all.as2.style.display="none"
listform.all.xxx.all.as3.style.display="none"
listform.all.xxx.all.as4.style.display=""
listform.all.xxx.all.as5.style.display="none"
listform.all.xxx.all.as6.style.display="none"
}
else if(tabContent.id=="t5Contents"){
listform.all.xxx.all.as0.style.display="none"
listform.all.xxx.all.as1.style.display="none"
listform.all.xxx.all.as2.style.display="none"
listform.all.xxx.all.as3.style.display="none"
listform.all.xxx.all.as4.style.display="none"
listform.all.xxx.all.as5.style.display=""
listform.all.xxx.all.as6.style.display="none"
}
else if(tabContent.id=="t6Contents"){
listform.all.xxx.all.as0.style.display="none"
listform.all.xxx.all.as1.style.display="none"
listform.all.xxx.all.as2.style.display="none"
listform.all.xxx.all.as3.style.display="none"
listform.all.xxx.all.as4.style.display="none"
listform.all.xxx.all.as5.style.display="none"
listform.all.xxx.all.as6.style.display=""
}
}
}
function addfun() {	
	listform.submit();
}

</script>
<style>
.conts  {visibility:hidden}
.tab{
	border-top:1px solid #FFFFFF;
	border-right:1px solid gray;
	border-left:1px solid #FFFFFF;
	font-family:Verdana;
	font-size:10pt;
	text-align:center;
	font-weight:normal;
	cursor: default;
	border-bottom-width: 1px;
	border-bottom-style: solid;
	border-bottom-color: gray;
}
.selTab{border-left:solid thin white;
border-top:solid thin white;
border-right:solid thin black;
font-weight:bold;
text-align:center;
cursor: default}
table {  font-size: 9pt}
</style>
<SCRIPT LANGUAGE="JavaScript">
<!-- Hide
function killErrors() {
return true;
}
window.onerror = killErrors;
// -->
</SCRIPT>
<style type="text/css">
<!--
body {  font-size: 9pt}
.tas {  border-color: black #FFFFFF; border-style: solid; border-top-width: 0px; border-right-width: 1px; border-bottom-width: 0px; border-left-width: 1px}
table {  font-size: 9pt}
.gray1 { filter:gray }
.ttbbd {  cursor: default}
-->
</style>
<SCRIPT LANGUAGE="JavaScript">

function chpass() {
	
	if(listform.userid.value=="" || listform.userid.value=="1" ){
		alert("该用户无法修改密码！");
		return ;
	} 	

	if(listform.pass.value=="" || listform.repass.value==""){
		alert("密码不能为空!");
		return;
	}
	if(listform.pass.value!=listform.repass.value){
		alert("密码不一致!");
		return;
	}
	

	listform.Fun.value="ltchpass";
	listform.submit();
}

function deluser() {

	if(listform.userid.value=="" || listform.userid.value=="1"){
		alert("该用户无法删除！");
		return ;
	} 
	listform.Fun.value="ltdeluser";
	listform.submit();

}

function exportkey() {

	if(listform.userid.value=="" || listform.userid.value=="1"){
		alert("该用户key无法导出！");
		return ;
	} 
	listform.Fun.value="ltuserkeyexport";
	listform.submit();

}

function addfun() {
	/*验证IP*/
	var myip=listform.ipadd.value;
	var myname=listform.username.value;
	var mydisname=listform.dispname.value;
	if(myname=="" || myname==""){
		alert("帐号名不能为空!");
		return;
	}
	if(mydisname=="" || mydisname==""){
		alert("名称不能为空!");
		return;
	}
	if(myip=="" || myip==""){
		alert("ip地址不能为空!");
		return;
	}
	var regIP=/^(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])$/;
	var IP_flag=false;
	if(regIP.test(myip)){
	IP_flag = true;
	}else{
	IP_flag = false;
	}
	if (!IP_flag){
	  alert("对不起，ip地址格式错误！");
	listform.ipadd.focus();
	listform.ipadd.select();
	  return false;
	}
	/*验证MAC*/
	chkstr=listform.macadd.value;
	if(chkstr=="" || chkstr==""){
		alert("MAC地址不能为空!");
		return false;
	}
	var pattern="/^([0-9A-Fa-f]{2})(-[0-9A-Fa-f]{2}){5}|([0-9A-Fa-f]{2})(:[0-9A-Fa-f]{2}){5}/";
	eval("var pattern=" + pattern);
	var add_p1 = pattern.test(chkstr);

	if(add_p1==false)
	{
	alert("你输入的MAC地址不正确。");
	return false;
	}

	
	listform.submit();
}
</SCRIPT>

</head>

<body bgcolor="#ffffff" text="#000000"  leftmargin="1" topmargin="0" >

  <div id="xxx" STYLE="position:absolute; top:0px; height:90%; width:100%; left:0px; border:none thin gray; visibility: visible"> 
    <table border="1"  bordercolorlight=#000000 bordercolordark=#ffffff  CELLPADDING="0" CELLSPACING="0" bgcolor=#f0f0f0 STYLE="width:100%; height:100%">
      <tr>
	    <td ID="t0" CLASS="selTab" HEIGHT="25" width="144" onClick="changeTabs()" >帐号信息</td>
     </tr> 
<tr> 
<td ID="t0base" STYLE="height:2; border-left:solid thin white" width="137"></td>

<td width="874"  STYLE="height:2; background-color:white;width="5"> </td>
</tr> 
<tr> 
<td HEIGHT="*" COLSPAN="10" ID="tabContents"  > 
<div id="as0" valign="top">
	<form name="listform" action="/icm/main.xp" method="POST">
	<INPUT name="Fun"  type="hidden" value="icmTerminfoAdd">
      <table  background-color:#f0f0f0; width="89%" border="0" align="center">
        <tr> 
          <td colspan="4"> 
            您可以修改登录名和密码,及所属分类</td>
        </tr>
        <tr> 
          <td width="8%">帐号名 </td>
          <td width="27%"> 
              <input type="text"  name="username" value="" class="inputf0" >          </td>
	  <td width="13%">该帐号有效日期至 </td> 
          <td width="52%"><input type="text" id="edate" class=inputf0 name="edate" size="20" maxlength="32" values="" onfocus=setday(edate) ></td>
        </tr>
        <tr> 
          <td>名称</td>
          <td><input type="text"  name="dispname" value="" class="inputf0" ></td>
         <td>MAC 地址 </td> 
          <td><input type="text" name="macadd" value="" class="inputf0" id="macadd"></td>
          <td><input type="hidden" name="id" value="[$id$]" class="inputf0"></td>
		  <td><input type="hidden" name="type" value="1" class="inputf0"></td>
        </tr>
	    <tr> 
            <td width="8%">IP 地址 </td>
            <td width="27%"> 
              <input type="text" name="ipadd" value="" class="inputf0" id="ipadd" >          </td>
            <td width="13%">Email</td>
            <td width="52%"><input type="text" name="email" value="" class="inputf0" id="email" ></td>
        </tr>
        <tr> 
            <td width="8%">电话</td>
            <td width="27%"> 
              <input type="text" name="telphone" value="" class="inputf0" id="telphone"></td>
            <td width="13%">用户状态</td>
            <td width="52%"><select name="status" class="inputf0">
              <option value="0" selected>正常</option>
              <option value="1">锁定</option>
            </select>
            </td>
        </tr>
        <tr><td><INPUT style="border: 2 solid #a5b4b4;cursor: hand" onClick="addfun();" class="inputf0" type="button" value=添加新用户 name=BtnReload></td></tr>
      </table>
	  </form>
	  
       </div>
<div id="as1" align="center"  STYLE="display: none;" >       
</div>

<div id="as2" align="center" STYLE="display: none;">
 </div>
 
<div id="as3" valign="top" align="center" STYLE="display: none; position:absolute; top=50; width:100%; height:400; z-index:1; overflow: scroll;">
	
</div>

<div id="as4" align="center" STYLE="display: none">	
 </div>

<div id="as5" align="center" STYLE="display: none">
<iframe width="100%" id="xxmwlj" src="/main/main.xp?Fun=ltuserlog+where="   height="100%" frameborder="no"  ></iframe>
</div>
</td></tr></table>
</div> 


</body>
</html>
